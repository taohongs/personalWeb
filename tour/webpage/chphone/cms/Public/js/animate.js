function toOffset(a){switch(a){case"left":var b="offsetLeft";break;case"top":var b="offsetTop";break;case"width":var b="offsetWidth";break;case"height":var b="offsetHeight";break;case"scrollTop":var b="scrollTop";break;default:throw alert("不支持此方向的动画效果！"),new Error("不支持此方向的动画效果！")}return b}function animate(a,b,c,d,e){function f(){if(window.clearTimeout(a.timer),q<i&&k.length){q+=r,q/i>=1&&(q=i);for(var b in j)if("opacity"==b){var c=h(q,parseFloat(j[b]),parseFloat(k[b]),i);a.style[b]=c,a.style.filter="alpha(opacity="+100*c+")"}else"scrollTop"==b?a[b]=h(q,j[b],k[b],i):a.style[b]=h(q,j[b],k[b],i)+"px";a.timer=window.setTimeout(f,r)}else a.timer=null,e&&e.call(a)}if(!a||1!=a.nodeType)throw alert("第一个参数ele错误！"),new Error("第一个参数ele错误！");if("object"!=typeof b)throw alert("第二个参数obj错误！"),new Error("参数obj错误！");var g=/^\d+$/;if(g.test(c));else{if("undefined"!=typeof c)throw alert("第三个参数nDuration错误！"),new Error("第三个参数nDuration错误！");c=700}if(d){if("number"==typeof d)switch(d){case 1:var h=effect.zfLinear;break;case 2:var h=effect.Quart.easeInOut;break;case 3:var h=effect.Elastic.easeOut;break;case 4:var h=effect.zfBounce.easeOut;break;default:throw alert("目前不支持此数字类型的运动效果！"),new Error("目前不支持此数字类型的运动效果！")}else if(d instanceof Array)if("zfLinear"==d[0])var h=effect.zfLinear;else var h=effect[d[0]][d[1]];else if("function"==typeof d){var h=effect.zfLinear;e=d}}else var h=effect.zfLinear;var i=c,j={},k={};k.length=0;for(var l in b){if("opacity"==l){if(b.opacity>1||b.opacity<0)throw alert("opacity的值超过范围！"),new Error("opacity的值超过范围！");if(a.currentStyle)var m=a.currentStyle.opacity;else var m=window.getComputedStyle(a,null).opacity;"undefined"!=typeof m?(a.style.opacity=m,a.style.filter="alpha(opacity="+100*m+")"):(a.style.opacity=1,a.style.filter="alpha(opacity=100)");var n=a.style.opacity,o=b.opacity-n}else var p=toOffset(l),n=a[p],o=b[l]-n;o&&(k[l]=o,j[l]=n,k.length++)}var q=0;if(document.all)var r=15;else var r=13;f()}var effect={zfLinear:function(a,b,c,d){return c*a/d+b},Quad:{easeIn:function(a,b,c,d){return c*(a/=d)*a+b},easeOut:function(a,b,c,d){return-c*(a/=d)*(a-2)+b},easeInOut:function(a,b,c,d){return(a/=d/2)<1?c/2*a*a+b:-c/2*(--a*(a-2)-1)+b}},Cubic:{easeIn:function(a,b,c,d){return c*(a/=d)*a*a+b},easeOut:function(a,b,c,d){return c*((a=a/d-1)*a*a+1)+b},easeInOut:function(a,b,c,d){return(a/=d/2)<1?c/2*a*a*a+b:c/2*((a-=2)*a*a+2)+b}},Quart:{easeIn:function(a,b,c,d){return c*(a/=d)*a*a*a+b},easeOut:function(a,b,c,d){return-c*((a=a/d-1)*a*a*a-1)+b},easeInOut:function(a,b,c,d){return(a/=d/2)<1?c/2*a*a*a*a+b:-c/2*((a-=2)*a*a*a-2)+b}},Quint:{easeIn:function(a,b,c,d){return c*(a/=d)*a*a*a*a+b},easeOut:function(a,b,c,d){return c*((a=a/d-1)*a*a*a*a+1)+b},easeInOut:function(a,b,c,d){return(a/=d/2)<1?c/2*a*a*a*a*a+b:c/2*((a-=2)*a*a*a*a+2)+b}},Sine:{easeIn:function(a,b,c,d){return-c*Math.cos(a/d*(Math.PI/2))+c+b},easeOut:function(a,b,c,d){return c*Math.sin(a/d*(Math.PI/2))+b},easeInOut:function(a,b,c,d){return-c/2*(Math.cos(Math.PI*a/d)-1)+b}},Expo:{easeIn:function(a,b,c,d){return 0==a?b:c*Math.pow(2,10*(a/d-1))+b},easeOut:function(a,b,c,d){return a==d?b+c:c*(-Math.pow(2,-10*a/d)+1)+b},easeInOut:function(a,b,c,d){return 0==a?b:a==d?b+c:(a/=d/2)<1?c/2*Math.pow(2,10*(a-1))+b:c/2*(-Math.pow(2,-10*--a)+2)+b}},Circ:{easeIn:function(a,b,c,d){return-c*(Math.sqrt(1-(a/=d)*a)-1)+b},easeOut:function(a,b,c,d){return c*Math.sqrt(1-(a=a/d-1)*a)+b},easeInOut:function(a,b,c,d){return(a/=d/2)<1?-c/2*(Math.sqrt(1-a*a)-1)+b:c/2*(Math.sqrt(1-(a-=2)*a)+1)+b}},Elastic:{easeIn:function(a,b,c,d,e,f){if(0==a)return b;if(1==(a/=d))return b+c;if(f||(f=.3*d),!e||e<Math.abs(c)){e=c;var g=f/4}else var g=f/(2*Math.PI)*Math.asin(c/e);return-(e*Math.pow(2,10*(a-=1))*Math.sin((a*d-g)*(2*Math.PI)/f))+b},easeOut:function(a,b,c,d,e,f){if(0==a)return b;if(1==(a/=d))return b+c;if(f||(f=.3*d),!e||e<Math.abs(c)){e=c;var g=f/4}else var g=f/(2*Math.PI)*Math.asin(c/e);return e*Math.pow(2,-10*a)*Math.sin((a*d-g)*(2*Math.PI)/f)+c+b},easeInOut:function(a,b,c,d,e,f){if(0==a)return b;if(2==(a/=d/2))return b+c;if(f||(f=d*(.3*1.5)),!e||e<Math.abs(c)){e=c;var g=f/4}else var g=f/(2*Math.PI)*Math.asin(c/e);return a<1?-.5*(e*Math.pow(2,10*(a-=1))*Math.sin((a*d-g)*(2*Math.PI)/f))+b:e*Math.pow(2,-10*(a-=1))*Math.sin((a*d-g)*(2*Math.PI)/f)*.5+c+b}},Back:{easeIn:function(a,b,c,d,e){return void 0==e&&(e=1.70158),c*(a/=d)*a*((e+1)*a-e)+b},easeOut:function(a,b,c,d,e){return void 0==e&&(e=1.70158),c*((a=a/d-1)*a*((e+1)*a+e)+1)+b},easeInOut:function(a,b,c,d,e){return void 0==e&&(e=1.70158),(a/=d/2)<1?c/2*(a*a*(((e*=1.525)+1)*a-e))+b:c/2*((a-=2)*a*(((e*=1.525)+1)*a+e)+2)+b}},zfBounce:{easeIn:function(a,b,c,d){return c-effect.zfBounce.easeOut(d-a,0,c,d)+b},easeOut:function(a,b,c,d){return(a/=d)<1/2.75?c*(7.5625*a*a)+b:a<2/2.75?c*(7.5625*(a-=1.5/2.75)*a+.75)+b:a<2.5/2.75?c*(7.5625*(a-=2.25/2.75)*a+.9375)+b:c*(7.5625*(a-=2.625/2.75)*a+.984375)+b},easeInOut:function(a,b,c,d){return a<d/2?.5*effect.zfBounce.easeIn(2*a,0,c,d)+b:.5*effect.zfBounce.easeOut(2*a-d,0,c,d)+.5*c+b}}},lunbo={};E.bind(window,"load",function(){for(var a=DOM.getClassName("lunbo_leftRight"),b=0;b<a.length;b++){var c=DOM.getClassName("lunbo_leftRight_left",a[b])[0],d=DOM.getClassName("lunbo_leftRight_right",a[b])[0],e=DOM.getClassName("lunbo_leftRight_ul",a[b])[0],f=DOM.getClassName("lunbo_leftRight_list",a[b])[0],g=a[b].getAttribute("speed")||1e3,h=a[b].getAttribute("interval")||3e3,i=a[b].getAttribute("auto")||!1,j="shangxia"==a[b].getAttribute("fangxiang")?"top":"left",k=a[b].getAttribute("gunlun")||!1,l=a[b].getAttribute("hoverClear")||!1,m=e.getElementsByTagName("li").item(0).offsetWidth;"top"==j&&(m=e.getElementsByTagName("li").item(0).offsetHeight),lunbo.leftRight(e,m,g,h,1,"select","","click",f,c,d,l,j,i,k)}}),lunbo.leftRight=function(lunbo_ul,liWidth,speed,t,effectType,listSelectClass,listOutClass,listOnType,list,left,right,hoverClear,fangxiang,auto,gunlun){function gunlun_out(a){var a=a||window.event;a.preventDefault()}function gunlun_over(a){a.wheelDelta>=0||a.detail<0?leftOnclick():rightOnclick(),window.removeEventListener("DOMMouseScroll",gunlun_over),window.addEventListener("DOMMouseScroll",gunlun_out),window.onmousewheel=gunlun_out,window.setTimeout(function(){window.onmousewheel=gunlun_over,window.addEventListener("DOMMouseScroll",gunlun_over)},1e3)}function rightOnclick(){clearInter(),index++,index==length&&(index=1,lunbo_ul.style[fangxiang]=0),move(),auto&&starInter()}function leftOnclick(){clearInter(),0==index&&(index=length-1,lunbo_ul.style[fangxiang]=-(length-1)*liWidth+"px"),index--,move(),auto&&starInter()}function move(){if(list&&(lists=list[index==list.length?0:index],lists.className=listSelectClass,outList.className=listOutClass,outList=lists),"left"==fangxiang){try{eval(lis[index].getAttribute("fn"))()}catch(a){}animate(lunbo_ul,{left:-index*liWidth},speed,effectType)}else{try{eval(lis[index].getAttribute("fn"))()}catch(a){}animate(lunbo_ul,{top:-index*liWidth},speed,effectType)}}function clearInter(){window.clearInterval(timer)}function starInter(){timer=window.setInterval(rightOnclick,t)}var index=0,timer=null,li=DOM.firstEleChild(lunbo_ul).cloneNode(!0);lunbo_ul.appendChild(li);var lis=DOM.siblingsAll(DOM.firstEleChild(lunbo_ul)),length=DOM.eleIndex(DOM.lastEleChild(lunbo_ul));if(list=DOM.siblingsAll(DOM.firstEleChild(list)),lunbo_ul.style.width=length*liWidth+"px",list){length-1!=list.length&&alert("轮播图和序号长度不一致");for(var i=0;i<list.length;i++)list[i].index=i,E.bind(list[i],listOnType,function(){clearInter(),index=this.index,move(),auto&&starInter()});var outList=list[0]}left&&E.bind(left,"click",rightOnclick),gunlun&&(window.onmousewheel=gunlun_over,window.addEventListener("DOMMouseScroll",gunlun_over)),right&&E.bind(right,"click",leftOnclick),auto&&starInter(),auto&&hoverClear&&(E.bind(lunbo_ul,"mouseover",function(){clearInter()}),E.bind(lunbo_ul,"mouseout",function(){starInter()}))},E.bind(window,"load",function(){for(var a=DOM.getClassName("lunbo_opacity"),b=0;b<a.length;b++){var c=DOM.getClassName("lunbo_opacity_ul",a[b])[0],d=DOM.getClassName("lunbo_opacity_left",a[b])[0],e=DOM.getClassName("lunbo_opacity_right",a[b])[0],f=DOM.getClassName("lunbo_opacity_list",a[b])[0],g=a[b].getAttribute("speed")||1e3,h=a[b].getAttribute("interval")||3e3;lunbo.opacity(c,g,h,f,"select","","click",d,e)}}),lunbo.opacity=function(a,b,c,d,e,f,g,h,i){function j(){m(),p++,p=p==t?0:p,l(),n()}function k(){m(),p=0==p?t:p,p--,l(),n()}function l(){q!=p&&(animate(r[q],{opacity:0},b),animate(r[p],{opacity:1},b),r[p].style.zIndex=t,r[q].style.zIndex=0,s&&(s[p].className=e,s[q].className=f),q=p)}function m(){window.clearInterval(o)}function n(){o=window.setInterval(j,c)}var o,p=0,q=0,r=DOM.siblings(DOM.firstEleChild(a));if(r.unshift(DOM.firstEleChild(a)),d){var s=DOM.siblings(DOM.firstEleChild(d));s.unshift(DOM.firstEleChild(d))}var t=r.length;if(s&&t!=s.length)throw alert("轮播图和序号长度不一致"),new Errow("轮播图和序号长度不一致");for(var u=0;u<t;u++)r[u].style.zIndex=t-u,r[u].style.opacity=0,r[u].style.filter="alpha(opacity=0)",s&&(s[u].index=u,E.bind(s[u],g,function(){m(),p=this.index,l(),n()}));h&&E.bind(h,"click",j),i&&E.bind(i,"click",k),r[p].style.opacity=1,r[p].style.filter="alpha(opacity=100)",n()},E.bind(window,"load",function(){for(var a=DOM.getClassName("lunbo_jiaodian"),b=0;b<a.length;b++){var c=DOM.getClassName("lunbo_jiaodian_ul",a[b])[0],d=DOM.getClassName("lunbo_jiaodian_left",a[b])[0],e=DOM.getClassName("lunbo_jiaodian_right",a[b])[0],f=(DOM.getClassName("lunbo_jiaodian_list",a[b])[0],a[b].getAttribute("speed")||1e3),g=a[b].getAttribute("interval")||3e3,h=a[b].getAttribute("hoverClear")||!1,i=a[b].getAttribute("liWidth")||.8*c.offsetWidth;lunbo.jiaodianlunbo(a[b],c,i,f,g,1,d,e,h)}}),lunbo.jiaodianlunbo=function(a,b,c,d,e,f,g,h,i){function j(){E.unBind(w,"click",k),C.style.zIndex=3,animate(C,{width:r,height:s,left:r,top:t},d,f),y=0==C.index?n[u-1]:DOM.previousEleChild(C),z=C.index==u-1?n[0]:DOM.nextEleChild(C),z.style.zIndex=2,B=z.index==u-1?n[0]:DOM.nextEleChild(z),A=0==y.index?n[u-1]:DOM.previousEleChild(y),y.style.zIndex=5,A.style.left=0,A.style.zIndex=1,animate(y,{width:c,height:p,left:(q-c)/2,top:0},d,f),C=y,window.setTimeout(function(){E.bind(w,"click",k)},d)}function k(){E.unBind(v,"click",j),animate(C,{width:r,height:s,left:0,top:t},d,f),C.style.zIndex=3,z=C.index==u-1?z=n[0]:DOM.nextEleChild(C),y=0==C.index?n[u-1]:DOM.previousEleChild(C),y.style.zIndex=2,A=0==y.index?n[u-1]:DOM.previousEleChild(y),A.style.zIndex=1,B=z.index==u-1?n[0]:DOM.nextEleChild(z),z.style.zIndex=5,B.style.left=r+"px",B.style.zIndex=1,animate(z,{width:c,height:p,left:(q-c)/2,top:0},d,f),C=z,window.setTimeout(function(){E.bind(v,"click",j)},d)}function l(){window.clearInterval(o)}function m(){o=window.setInterval(j,e)}var n=DOM.siblings(DOM.lastEleChild(b));n.push(DOM.lastEleChild(b));var o,p=parseInt(DOM.getStyle(b,"height"),10),q=parseInt(DOM.getStyle(b,"width"),10),r=q/2,s=parseInt(DOM.getStyle(n[0],"height"),10),t=(p-s)/2,u=n.length,v=document.createElement("div"),w=document.createElement("div");v.style.backgroundColor=w.style.backgroundColor="#fff",v.style.filter=w.style.filter="alpha(opacity=30)",v.style.position=w.style.position="absolute",v.style.height=w.style.height=s+"px",v.style.cursor=w.style.cursor="pointer",v.style.width=w.style.width=r+"px",v.style.opacity=w.style.opacity=.3,v.style.top=w.style.top=t+"px",v.style.zIndex=w.style.zIndex=4,v.style.left=0,w.style.right=0,b.appendChild(v),b.appendChild(w);for(var x=0;x<u;x++)n[x].index=x,n[x].style.top=t+"px",n[x].style.width=r+"px",0==x?(n[x].style.zIndex=5,n[x].style.left=(q-c)/2+"px",n[x].style.top=0,n[x].style.width=c+"px",n[x].style.height=p+"px"):x==u-1?(n[x].style.zIndex=2,n[x].style.left=0):1==x?(n[x].style.zIndex=2,n[x].style.left=r+"px"):n[x].style.zIndex=1;var y,z,A,B,C=n[0];E.bind(v,"click",j),g&&E.bind(g,"click",j),h&&E.bind(h,"click",k),E.bind(w,"click",k),m(),v.onmouseover=w.onmouseover=function(){this.style.filter="alpha(opacity=10)",this.style.opacity=.1},v.onmouseout=w.onmouseout=function(){this.style.filter="alpha(opacity=30)",this.style.opacity=.3},i&&(E.bind(a,"mouseover",function(){l()}),E.bind(a,"mouseout",function(){m()}))};